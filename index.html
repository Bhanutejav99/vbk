<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VBK Designs | Premium Boutique</title>

    <!-- PWA Meta -->
    <meta name="theme-color" content="#0f1424">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="manifest.json">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap"
        rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    },
                    colors: {
                        vbk: {
                            navy: '#0f1424',
                            dark: '#050811',
                            card: '#1c2136',
                            gold: '#f9b17a',
                            goldDim: '#c48b5e',
                            accent: '#6769fd',
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out forwards',
                        'slide-up': 'slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'pop': 'pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)',
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        slideUp: { '0%': { transform: 'translateY(20px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } },
                        pop: { '0%': { transform: 'scale(0.8)' }, '50%': { transform: 'scale(1.2)' }, '100%': { transform: 'scale(1)' } }
                    }
                }
            }
        }
    </script>

    <style>
        /* Custom Utilities */
        body {
            background-color: #0f1424;
            color: white;
            -webkit-tap-highlight-color: transparent;
        }

        .glass {
            background: rgba(15, 20, 36, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-top: 1px solid rgba(255, 255, 255, 0.08);
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .story-ring {
            background: linear-gradient(45deg, #f9b17a, #6769fd);
            padding: 2px;
            border-radius: 50%;
        }

        .loader {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(249, 177, 122, 0.3);
            border-radius: 50%;
            border-top-color: #f9b17a;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body class="pb-24">

    <!-- App Container -->
    <div id="app" class="max-w-md mx-auto min-h-screen relative bg-vbk-navy shadow-2xl overflow-hidden">

        <!-- Top Bar -->
        <header
            class="fixed top-0 w-full max-w-md z-50 glass px-4 py-3 flex justify-between items-center transition-transform duration-300"
            id="top-bar">
            <div class="flex items-center gap-2">
                <h1 class="font-serif text-xl font-bold tracking-wide text-white">VBK<span
                        class="text-vbk-gold">.</span></h1>
            </div>
            <div class="flex items-center gap-4">
                <button class="relative text-gray-300 hover:text-white transition">
                    <i class="fa-regular fa-bell text-xl"></i>
                    <span class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"></span>
                </button>
                <button onclick="app.toggleCart()" class="relative text-gray-300 hover:text-white transition">
                    <i class="fa-solid fa-bag-shopping text-xl"></i>
                    <span id="cart-badge"
                        class="absolute -top-1 -right-1 bg-vbk-gold text-vbk-navy text-[10px] font-bold w-4 h-4 rounded-full flex items-center justify-center opacity-0 transition-opacity">0</span>
                </button>
            </div>
        </header>

        <!-- Main Content Area -->
        <main id="main-content" class="pt-16 px-4">

            <!-- Stories / Categories -->
            <div class="flex gap-4 overflow-x-auto no-scrollbar py-4 mb-2" id="stories-container">
                <!-- Injected via JS -->
                <div class="flex flex-col items-center gap-1 min-w-[70px] cursor-pointer group">
                    <div
                        class="w-16 h-16 rounded-full bg-vbk-card flex items-center justify-center border border-white/10 group-hover:border-vbk-gold transition">
                        <div class="loader"></div>
                    </div>
                    <span class="text-[10px] text-gray-400">Loading...</span>
                </div>
            </div>

            <!-- Hero Banner -->
            <div class="relative w-full h-48 rounded-2xl overflow-hidden mb-8 group">
                <img src="https://images.unsplash.com/photo-1583391733958-e004e45d8b60?w=800&q=80"
                    class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
                    alt="Hero">
                <div class="absolute inset-0 bg-gradient-to-t from-vbk-navy/80 to-transparent flex items-end p-6">
                    <div>
                        <span class="text-vbk-gold text-xs font-bold uppercase tracking-wider mb-1 block">New
                            Collection</span>
                        <h2 class="text-2xl font-serif font-bold leading-tight">Bridal Elegance</h2>
                    </div>
                </div>
            </div>

            <!-- Product Grid -->
            <div class="grid grid-cols-2 gap-4 pb-4" id="product-grid">
                <!-- Injected via JS -->
            </div>

            <!-- Loading State -->
            <div id="loading-indicator" class="flex justify-center py-8 hidden">
                <div class="loader"></div>
            </div>

        </main>

        <!-- Bottom Navigation -->
        <nav class="fixed bottom-0 w-full max-w-md z-50 glass px-6 py-3 flex justify-between items-center">
            <button onclick="app.navigate('home')"
                class="nav-btn active flex flex-col items-center gap-1 text-vbk-gold transition">
                <i class="fa-solid fa-house text-xl"></i>
                <span class="text-[10px] font-medium">Home</span>
            </button>
            <button onclick="app.navigate('search')"
                class="nav-btn flex flex-col items-center gap-1 text-gray-500 hover:text-white transition">
                <i class="fa-solid fa-magnifying-glass text-xl"></i>
                <span class="text-[10px] font-medium">Search</span>
            </button>
            <button onclick="app.navigate('wishlist')"
                class="nav-btn flex flex-col items-center gap-1 text-gray-500 hover:text-white transition">
                <i class="fa-regular fa-heart text-xl"></i>
                <span class="text-[10px] font-medium">Saved</span>
            </button>
            <button onclick="app.navigate('profile')"
                class="nav-btn flex flex-col items-center gap-1 text-gray-500 hover:text-white transition">
                <i class="fa-regular fa-user text-xl"></i>
                <span class="text-[10px] font-medium">Profile</span>
            </button>
        </nav>

        <!-- Product Detail Modal (Bottom Sheet) -->
        <div id="product-modal" class="fixed inset-0 z-[60] hidden">
            <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity opacity-0" id="modal-backdrop"
                onclick="app.closeProduct()"></div>
            <div class="absolute bottom-0 w-full bg-vbk-card rounded-t-3xl overflow-hidden transform translate-y-full transition-transform duration-300 flex flex-col max-h-[90vh]"
                id="modal-content">
                <!-- Content Injected via JS -->
            </div>
        </div>

    </div>

    <!-- Application Logic -->
    <script>
        // --- CONFIG ---
        const CONFIG = {
            sheetUrl: '', // User to provide this
            fallbackData: [
                { id: 'T1', title: 'Royal Blue Maggam', cat: 'Top Designs', price: 4500, img: 'https://images.unsplash.com/photo-1610030469983-98e550d6193c?w=500' },
                { id: 'T2', title: 'Emerald Zardosi', cat: 'Top Designs', price: 5200, img: 'https://images.unsplash.com/photo-1583391733958-e004e45d8b60?w=500' },
                { id: 'T3', title: 'Cutwork Design', cat: 'Top Designs', price: 3800, img: 'https://i.pinimg.com/1200x/7e/9f/95/7e9f95c8b51361b7215b80de1e42c96c.jpg?w=500' },
                { id: 'B1', title: 'Deep V Velvet', cat: 'Blouses', price: 2800, img: 'https://i.pinimg.com/1200x/c2/ce/5e/c2ce5e3880b5baa996ce5192ce09aa07.jpg?w=500' },
                { id: 'B2', title: 'Pot Neck Bridal', cat: 'Blouses', price: 8500, img: 'https://i.pinimg.com/736x/8b/9c/7b/8b9c7bd565d8d04c5c66357c2a0d8cd5.jpg?w=500' },
                { id: 'W1', title: 'Peacock Motif Heavy', cat: 'Wedding', price: 12000, img: 'https://images.unsplash.com/photo-1595514020182-52695528d91f?w=500' },
                { id: 'W2', title: 'Full Sleeve Stone', cat: 'Wedding', price: 15000, img: 'https://images.unsplash.com/photo-1610030469983-98e550d6193c?w=500' },
                { id: 'L1', title: 'Bridal Lehanga', cat: 'Lehangas', price: 15000, img: 'https://placehold.co/500x600/2d3250/ffffff?text=Lehanga' },
                { id: 'F1', title: 'Party Wear Frock', cat: 'Frocks', price: 3500, img: 'https://placehold.co/500x600/2d3250/ffffff?text=Frock' },
                { id: 'Mag1', title: 'Heavy Maggam Work', cat: 'Maggam', price: 5000, img: 'https://placehold.co/500x600/2d3250/ffffff?text=Maggam' },
                { id: 'K1', title: 'Designer Kurthi', cat: 'Kurthis', price: 1200, img: 'https://placehold.co/500x600/2d3250/ffffff?text=Kurthi' },
                { id: 'M1', title: 'Cotton Falls', cat: 'Materials', price: 250, img: 'https://placehold.co/400x400/2d3250/ffffff?text=Falls' }
            ]
        };

        // --- STORE ---
        const store = {
            products: [],
            cart: JSON.parse(localStorage.getItem('vbk_cart')) || [],
            wishlist: JSON.parse(localStorage.getItem('vbk_wishlist')) || [],

            init() {
                this.fetchProducts();
                this.updateUI();
            },

            async fetchProducts() {
                try {
                    if (CONFIG.sheetUrl) {
                        const res = await fetch(CONFIG.sheetUrl);
                        const text = await res.text();
                        this.products = this.parseCSV(text);
                    } else {
                        // Simulate network delay for effect
                        await new Promise(r => setTimeout(r, 800));
                        this.products = CONFIG.fallbackData;
                    }
                    app.renderStories();
                    app.renderGrid();
                } catch (e) {
                    console.error('Fetch error:', e);
                    this.products = CONFIG.fallbackData;
                    app.renderStories();
                    app.renderGrid();
                }
            },

            parseCSV(csv) {
                const lines = csv.split('\n').slice(1); // Skip header
                return lines.map(line => {
                    const [id, title, cat, sub, price, img] = line.split(',');
                    if (!id) return null;
                    return { id, title, cat, sub, price: Number(price), img: img?.trim() };
                }).filter(Boolean);
            },

            addToCart(product) {
                if (!this.cart.find(p => p.id === product.id)) {
                    this.cart.push(product);
                    this.save();
                    app.toast('Added to Bag');
                }
                this.updateUI();
            },

            removeFromCart(id) {
                this.cart = this.cart.filter(p => p.id !== id);
                this.save();
                this.updateUI();
            },

            save() {
                localStorage.setItem('vbk_cart', JSON.stringify(this.cart));
                localStorage.setItem('vbk_wishlist', JSON.stringify(this.wishlist));
            },

            updateUI() {
                const badge = document.getElementById('cart-badge');
                badge.textContent = this.cart.length;
                badge.style.opacity = this.cart.length ? '1' : '0';
            }
        };

        // --- APP CONTROLLER ---
        const app = {
            init() {
                store.init();
            },

            renderStories() {
                const categories = [...new Set(store.products.map(p => p.cat))];
                const container = document.getElementById('stories-container');

                container.innerHTML = categories.map((cat, i) => `
                    <div class="flex flex-col items-center gap-2 min-w-[70px] cursor-pointer group animate-fade-in" style="animation-delay: ${i * 100}ms">
                        <div class="story-ring p-[2px] rounded-full group-hover:scale-105 transition-transform">
                            <div class="w-16 h-16 rounded-full bg-vbk-card border-2 border-vbk-navy overflow-hidden">
                                <img src="https://placehold.co/100x100/1c2136/ffffff?text=${cat[0]}" class="w-full h-full object-cover">
                            </div>
                        </div>
                        <span class="text-[10px] font-medium text-gray-300 group-hover:text-white">${cat}</span>
                    </div>
                `).join('');
            },

            renderGrid() {
                const container = document.getElementById('product-grid');
                container.innerHTML = store.products.map((p, i) => `
                    <div class="bg-vbk-card rounded-xl overflow-hidden group relative animate-slide-up" style="animation-delay: ${i * 50}ms" onclick="app.openProduct('${p.id}')">
                        <div class="aspect-[3/4] overflow-hidden relative">
                            <img src="${p.img}" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" loading="lazy">
                            <button class="absolute bottom-2 right-2 w-8 h-8 bg-white/20 backdrop-blur rounded-full flex items-center justify-center text-white hover:bg-vbk-gold hover:text-vbk-navy transition" onclick="event.stopPropagation(); store.addToCart({id: '${p.id}', title: '${p.title}', price: ${p.price}, img: '${p.img}'})">
                                <i class="fa-solid fa-plus"></i>
                            </button>
                        </div>
                        <div class="p-3">
                            <h3 class="text-sm font-serif font-bold truncate text-white">${p.title}</h3>
                            <p class="text-xs text-gray-400 mb-1">${p.cat}</p>
                            <span class="text-vbk-gold font-bold text-sm">₹${p.price}</span>
                        </div>
                    </div>
                `).join('');
            },

            openProduct(id) {
                const p = store.products.find(p => p.id === id);
                if (!p) return;

                const modal = document.getElementById('product-modal');
                const content = document.getElementById('modal-content');
                const backdrop = document.getElementById('modal-backdrop');

                content.innerHTML = `
                    <div class="relative h-[50vh]">
                        <img src="${p.img}" class="w-full h-full object-cover">
                        <button onclick="app.closeProduct()" class="absolute top-4 right-4 w-10 h-10 bg-black/30 backdrop-blur rounded-full text-white flex items-center justify-center">
                            <i class="fa-solid fa-xmark"></i>
                        </button>
                    </div>
                    <div class="p-6 bg-vbk-card flex-grow flex flex-col">
                        <div class="flex justify-between items-start mb-2">
                            <div>
                                <h2 class="text-2xl font-serif font-bold text-white">${p.title}</h2>
                                <p class="text-gray-400 text-sm">${p.cat}</p>
                            </div>
                            <span class="text-2xl font-bold text-vbk-gold">₹${p.price}</span>
                        </div>
                        <p class="text-gray-400 text-sm leading-relaxed mb-6">
                            Exquisite craftsmanship meets modern design. This piece is handcrafted with premium materials, perfect for your special occasions.
                        </p>
                        <button onclick="store.addToCart({id: '${p.id}', title: '${p.title}', price: ${p.price}, img: '${p.img}'}); app.closeProduct()" class="mt-auto w-full bg-vbk-gold text-vbk-navy py-4 rounded-xl font-bold uppercase tracking-wider hover:bg-white transition">
                            Add to Bag
                        </button>
                    </div>
                `;

                modal.classList.remove('hidden');
                // Trigger animations
                requestAnimationFrame(() => {
                    backdrop.classList.remove('opacity-0');
                    content.classList.remove('translate-y-full');
                });
            },

            closeProduct() {
                const modal = document.getElementById('product-modal');
                const content = document.getElementById('modal-content');
                const backdrop = document.getElementById('modal-backdrop');

                content.classList.add('translate-y-full');
                backdrop.classList.add('opacity-0');

                setTimeout(() => {
                    modal.classList.add('hidden');
                }, 300);
            },

            toast(msg) {
                // Simple toast implementation
                const div = document.createElement('div');
                div.className = 'fixed top-20 left-1/2 -translate-x-1/2 bg-vbk-card border border-vbk-gold/30 text-white px-6 py-3 rounded-full shadow-xl z-[70] text-xs font-bold uppercase tracking-wider animate-pop';
                div.innerHTML = `<i class="fa-solid fa-check text-green-400 mr-2"></i> ${msg}`;
                document.body.appendChild(div);
                setTimeout(() => div.remove(), 2000);
            }
        };

        // Start App
        document.addEventListener('DOMContentLoaded', () => app.init());

    </script>
</body>

</html>